language: go
sudo: false

notifications:
  email:
    recipients:
      - parker714@foxmail.com
  on_success: change
  on_failure: always

go:
  - 1.12.x

install:
  - go get github.com/go-playground/overalls
  - go get github.com/mattn/goveralls
  - go get github.com/smartystreets/goconvey
  - mkdir -p $GOPATH/src/github.com/parker714
  - cd $GOPATH/src/github.com/parker714/rabbit

script:
  - overalls -project=github.com/parker714/rabbit -covermode=count -ignore='.git,_vendor'
  - goveralls -coverprofile=overalls.coverprofile -service=travis-ci -repotoken $COVERALLS_TOKEN
  - go test -race -coverprofile=coverage.txt -covermode=atomic
  - go test ./...

after_success:
  - bash <(curl -s https://codecov.io/bash)

env:
  global:
    secure: "K5n78ZzPrnr50VpYR347VOm4bSNhbv3h+eC+qQcsA9ovweFUqqHTFIQcS+8DWdXhTquc2jU7phX62zg3jgQ1EDnZYrNaLnMXkTbxXf4FXc3SvhUJU7mO8DUs+UV5Pj1dh66ck62UWAhpXX1TC74e3ru/vo7se8XuDjvfq7YeND1x+AFgMRgAvYsLAEA86qOzvjcS7P74Aul5DHwbKFNkPBhTD4+GptwimVvvh560BQpjriskWxyMwAjeKD0FKv7VyUcIaRw11yFGM/O7GlxiaRttoh0IUtvSo+AyLlEg8/Hf/+BeuSzVNL/rxHCcY1kqftFaD+iNsSkjortQjfExF0MszXZ4JOD8rrh59979UYH7qwOuvbPuYmxvDdC+XWdBxzU5dZRkMLNLZ/p6yH9/7mdAdXLinR54nCsCXZHFPDceTjkpDCHuijjQGVpO4sL0legq0L51Jv1mcL7rio5xXBx+/mbMTt1EFpQnQzTh6U7SBOAOYF8+KHyfrnB4K065K/CdNArZnOCEKgstrTrQrVKSRVcdvEjiNzpHhuvTLV7cRWQtgCgFqOXJZ102YA5tYMakQToKJ/ObtJ6RpO86wuaE3fOmSDy/tva/Dm4KBlS/cyHkkN9Iaat39dgjgF0qkgy41waHJH0KE0msR9F2Re2yq4g4WyW2jyl4hd+u8qc="
